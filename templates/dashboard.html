<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pinpointe Campaign Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect width="32" height="32" rx="8" fill="url(#grad)" />
            <path
              d="M8 16L14 22L24 10"
              stroke="white"
              stroke-width="3"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <defs>
              <linearGradient id="grad" x1="0" y1="0" x2="32" y2="32">
                <stop stop-color="#6366f1" />
                <stop offset="1" stop-color="#8b5cf6" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div class="header-title">
          <h1>Pinpointe Dashboard</h1>
          <span class="timezone-label"
            >EST &middot; Last synced: <span id="last-sync">--</span></span
          >
        </div>
      </div>
      <div class="header-right">
        <button id="sync-btn" class="btn btn-primary">
          <svg
            class="btn-icon spin-target"
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
          >
            <path
              d="M14 8A6 6 0 1 1 8 2"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
          <span class="btn-label">Fetch New Stats</span>
        </button>
        {% if role == 'super' %}
        <a href="/domains" class="btn btn-domains" title="Manage Domains">
          <svg
            class="btn-icon"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10" />
            <line x1="2" y1="12" x2="22" y2="12" />
            <path
              d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
            />
          </svg>
          <span class="btn-label">Domains</span>
        </a>
        {% endif %}
        <button class="btn btn-logout" title="Logout" onclick="confirmLogout()">
          <svg
            class="btn-icon"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
          <span class="btn-label">Logout</span>
        </button>
      </div>
    </header>

    <!-- ‚îÄ‚îÄ‚îÄ Toolbar ‚îÄ‚îÄ‚îÄ -->
    <div class="toolbar">
      <div class="tab-group">
        <button class="tab active" data-report="campaigns">üìä Campaigns</button>
        <button class="tab" data-report="seeds">üå± Seeds</button>
      </div>

      <div class="view-group">
        <button class="view-btn active" data-view="today">Today</button>
        <button class="view-btn" data-view="range">Date Range</button>
      </div>

      <div id="date-range" class="date-range" style="display: none">
        <label>From</label>
        <input type="date" id="start-date" />
        <label>To</label>
        <input type="date" id="end-date" />
      </div>

      <div class="domain-search">
        <label>üîç</label>
        <input type="text" id="domain-search" placeholder="Search domains‚Ä¶" />
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ Grand Totals ‚îÄ‚îÄ‚îÄ -->
    <section id="grand-totals" class="totals-grid" style="display: none">
      <div class="metric-card">
        <div class="metric-label">Total Sends</div>
        <div class="metric-value" id="total-sends">0</div>
      </div>
      <div class="metric-card accent-open">
        <div class="metric-label">Open Rate</div>
        <div class="metric-value" id="total-open-pct">0%</div>
        <div class="metric-sub" id="total-opens">0 opens</div>
      </div>
      <div class="metric-card accent-click">
        <div class="metric-label">Click Rate</div>
        <div class="metric-value" id="total-click-pct">0%</div>
        <div class="metric-sub" id="total-clicks">0 clicks</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Bounces</div>
        <div class="metric-value" id="total-bounces">0</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Unsubs</div>
        <div class="metric-value" id="total-unsubs">0</div>
      </div>
      <div class="metric-card accent-visitors">
        <div class="metric-label">Visitors</div>
        <div class="metric-value" id="total-visitors">0</div>
      </div>
      <div class="metric-card accent-leads">
        <div class="metric-label">Total Leads</div>
        <div class="metric-value" id="total-total-leads">0</div>
      </div>
      <div class="metric-card accent-conv">
        <div class="metric-label">Sold Leads</div>
        <div class="metric-value" id="total-sold-leads">0</div>
      </div>
      <div class="metric-card accent-revenue">
        <div class="metric-label">Revenue</div>
        <div class="metric-value" id="total-revenue">$0.00</div>
      </div>
      <div class="metric-card accent-epc">
        <div class="metric-label">EPC</div>
        <div class="metric-value" id="total-epc">$0.00</div>
      </div>
      <div class="metric-card accent-ecpm">
        <div class="metric-label">eCPM</div>
        <div class="metric-value" id="total-ecpm">$0.00</div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ State indicators ‚îÄ‚îÄ‚îÄ -->
    <div id="loading" class="state-msg" style="display: none">
      <div class="spinner"></div>
      <span>Loading campaigns&hellip;</span>
    </div>
    <div id="error-message" class="state-msg error" style="display: none"></div>
    <div id="no-data" class="state-msg" style="display: none">
      <span class="empty-icon">üì≠</span> No campaigns found for the selected
      period.
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ Campaign cards ‚îÄ‚îÄ‚îÄ -->
    <main id="campaigns-container" class="campaigns-container"></main>

    <!-- ‚îÄ‚îÄ‚îÄ Domain pagination ‚îÄ‚îÄ‚îÄ -->
    <div
      id="domain-pagination"
      class="domain-pagination"
      style="display: none"
    ></div>

    <script src="/static/js/dashboard.js"></script>
    <!-- Logout confirmation modal -->
    <div
      id="logout-overlay"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 200;
      "
    >
      <div
        style="
          background: #1e293b;
          border: 1px solid rgba(255, 255, 255, 0.06);
          border-radius: 12px;
          max-width: 380px;
          width: 90%;
          padding: 0;
          box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        "
      >
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.1rem 1.5rem;
            border-bottom: 1px solid #1e293b;
          "
        >
          <h2
            style="
              font-size: 1.05rem;
              font-weight: 700;
              color: #e2e8f0;
              margin: 0;
            "
          >
            Confirm Logout
          </h2>
          <button
            onclick="closeLogoutModal()"
            style="
              background: none;
              border: none;
              color: #94a3b8;
              cursor: pointer;
              font-size: 1.3rem;
            "
          >
            &times;
          </button>
        </div>
        <p
          style="
            padding: 1.25rem 1.5rem;
            font-size: 0.9rem;
            color: #94a3b8;
            line-height: 1.6;
            margin: 0;
          "
        >
          Are you sure you want to log out of the dashboard?
        </p>
        <div
          style="
            display: flex;
            justify-content: flex-end;
            gap: 0.6rem;
            padding: 1rem 1.5rem;
            border-top: 1px solid #1e293b;
          "
        >
          <button
            onclick="closeLogoutModal()"
            style="
              padding: 0.5rem 1rem;
              border-radius: 8px;
              border: 1px solid #1e293b;
              background: #111827;
              color: #94a3b8;
              cursor: pointer;
              font-weight: 600;
              font-size: 0.8rem;
              font-family: inherit;
            "
          >
            Cancel
          </button>
          <a
            href="/logout"
            style="
              padding: 0.5rem 1rem;
              border-radius: 8px;
              border: 1px solid rgba(239, 68, 68, 0.3);
              background: rgba(239, 68, 68, 0.15);
              color: #fca5a5;
              text-decoration: none;
              font-weight: 600;
              font-size: 0.8rem;
              font-family: inherit;
              display: inline-flex;
              align-items: center;
            "
            >Logout</a
          >
        </div>
      </div>
    </div>
    <script>
      function confirmLogout() {
        document.getElementById("logout-overlay").style.display = "flex";
      }
      function closeLogoutModal() {
        document.getElementById("logout-overlay").style.display = "none";
      }
      document
        .getElementById("logout-overlay")
        .addEventListener("click", function (e) {
          if (e.target === this) closeLogoutModal();
        });
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") closeLogoutModal();
      });
    </script>
  </body>
</html>
